# Crime Data Analysis & Perpetrator Identity Prediction

> **Bachelor's Final Year Project** — Sri Ramakrishna College of Arts & Science, Coimbatore (2025)  
> Submitted by: Maniarasan J (22127028)  
> Guide: Mr. R. Janarthanan MCA., M.Phil., (Ph.D)

---

## Project Overview

This system analyses the **Kaggle Homicide Reports Dataset (1980–2014)** and predicts
three key perpetrator attributes from crime-scene inputs:

| Task | Algorithm | Target |
|---|---|---|
| Age Prediction | Random Forest Regressor | `Perpetrator Age` |
| Gender Classification | MLP (Neural Network) | `Perpetrator Sex` |
| Relationship Prediction | XGBoost Classifier | `Relationship` |

It also provides an interactive Flask web dashboard with EDA charts covering trends,
weapons, geography, and more.

---

## Folder Structure

```
crime_analysis/
├── data/
│   ├── raw/
│   │   └── database.csv          ← place the dataset here
│   └── processed/
│       └── crime_cleaned.csv     ← generated by pipeline
├── models/
│   ├── label_encoders.pkl
│   ├── age_prediction.pkl
│   ├── mlp_gender_model.pkl
│   └── xgboost_relationship_model.pkl
├── reports/
│   ├── figures/                  ← EDA charts (PNG)
│   ├── age_model_metrics.csv
│   ├── gender_model_metrics.csv
│   └── relationship_model_metrics.csv
├── src/
│   ├── preprocess.py             ← data cleaning & encoding
│   ├── analysis.py               ← EDA chart generation
│   ├── train_age_model.py        ← Random Forest training
│   ├── train_gender_model.py     ← MLP training
│   └── train_relationship_model.py ← XGBoost training
├── app/
│   ├── app.py                    ← Flask web application
│   └── templates/
│       ├── base.html
│       ├── index.html
│       ├── analysis.html
│       ├── predict.html
│       └── metrics.html
├── utils/
│   └── helpers.py                ← shared utilities
├── run_pipeline.py               ← one-command full pipeline
└── requirements.txt
```

---

## Prerequisites

- **Python 3.9+**
- The dataset file `database.csv` placed in `data/raw/`

---

## Environment Setup

```bash
# 1. Create and activate a virtual environment (recommended)
python -m venv venv
source venv/bin/activate          # Windows: venv\Scripts\activate

# 2. Install all dependencies
pip install -r requirements.txt
```

---

## How to Run

### Option A — Full Pipeline (recommended for first run)

```bash
python run_pipeline.py
```

This single command:
1. Preprocesses & encodes the raw dataset → `data/processed/crime_cleaned.csv`
2. Generates all EDA charts → `reports/figures/`
3. Trains the Random Forest age model → `models/age_prediction.pkl`
4. Trains the MLP gender model → `models/mlp_gender_model.pkl`
5. Trains the XGBoost relationship model → `models/xgboost_relationship_model.pkl`

Expected runtime: **~10–20 minutes** depending on hardware.

### Option B — Individual Steps

```bash
python src/preprocess.py              # Step 1: preprocess
python src/analysis.py                # Step 2: EDA charts
python src/train_age_model.py         # Step 3: age model
python src/train_gender_model.py      # Step 4: gender model
python src/train_relationship_model.py # Step 5: relationship model
```

### Launch the Web Application

```bash
python app/app.py
```

Then open **http://127.0.0.1:5000** in your browser.

---

## Web Application Pages

| Route | Description |
|---|---|
| `/` | Home / landing page |
| `/analysis` | EDA charts (rendered after `analysis.py`) |
| `/predict` | Interactive perpetrator prediction form |
| `/metrics` | Model performance dashboard |
| `/api/predict` | JSON REST endpoint (POST) |

### REST API Usage

```bash
curl -X POST http://127.0.0.1:5000/api/predict \
  -H "Content-Type: application/json" \
  -d '{
    "state": "California",
    "year": 2005,
    "month": "June",
    "crime_type": "Murder or Manslaughter",
    "crime_solved": "Yes",
    "victim_sex": "Female",
    "victim_age": 34,
    "victim_count": 1,
    "weapon": "Handgun"
  }'
```

**Response:**
```json
{
  "age_prediction": 28,
  "gender_prediction": "Male",
  "relationship_prediction": "Acquaintance"
}
```

---

## Dataset

- **Source**: Kaggle Homicide Reports Dataset (1980–2014)
- **Filename**: `database.csv`
- **Records**: 638,454
- **Key columns used**:
  - `State`, `Year`, `Month`
  - `Crime Type`, `Crime Solved`, `Weapon`
  - `Victim Sex`, `Victim Age`, `Victim Count`
  - `Perpetrator Age` *(age target)*
  - `Perpetrator Sex` *(gender target)*
  - `Relationship` *(relationship target)*

---

## Preprocessing Steps

1. Drop identifier & low-value columns (`Record ID`, `Agency Code`, etc.)
2. Coerce `Perpetrator Age` (object) → integer; replace age=0 and NaN with median
3. Fill missing categorical fields with `"Unknown"`
4. Label-encode all string columns
5. Save processed CSV + encoders

---

## Model Details

### 1. Age Prediction (Random Forest Regressor)
- `n_estimators=100`, `max_depth=15`, `min_samples_split=10`
- Metrics: MAE, MSE, RMSE, R²

### 2. Gender Classification (MLP Classifier)
- Rows with `Perpetrator Sex = Unknown` excluded (cleaner binary task)
- Architecture: `(128, 64)` hidden layers, ReLU, Adam, `early_stopping=True`
- Features scaled with `StandardScaler`
- Metrics: Accuracy, Precision, Recall, F1

### 3. Relationship Prediction (XGBoost Classifier)
- `max_depth=6`, `learning_rate=0.1`, `n_estimators=200`
- 28 relationship classes
- Metrics: Accuracy, Precision, Recall, F1

---

## Hardware Requirements (from documentation)

| Environment | Processor | RAM | Storage |
|---|---|---|---|
| Development | Intel Core i3 / 2.6 GHz+ | 16 GB | 512 GB SSD |
| Deployment | Intel Core i5 8th Gen+ | 8 GB | 256 GB SSD |
| User | Intel Core i3+ | 4 GB | 128 GB |

---

## Dependencies

| Package | Purpose |
|---|---|
| `pandas`, `numpy` | Data manipulation |
| `scikit-learn` | Preprocessing, MLP, Random Forest |
| `xgboost` | Relationship classification |
| `joblib` | Model serialisation |
| `matplotlib`, `seaborn` | EDA charts |
| `flask` | Web application & REST API |

---

## Limitations

- Predictions depend on dataset completeness (US homicide records only, 1980–2014)
- Ethical/privacy considerations apply — predictions are probabilistic, not definitive
- `Perpetrator Age` imputed using median for all 'Unknown' cases during training

---

## Future Enhancements

- Real-time data integration (IoT / live crime feeds)
- Behavioural / psychological profiling models
- NLP on witness statements and crime reports
- Geographic expansion beyond US
- Predictive policing modules
- Community crime-reporting portal
